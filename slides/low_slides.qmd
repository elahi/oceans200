---
title: "review(topic = intro_stats, language = R)"
author: "Robin Elahi"
format: revealjs
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)

# Set working directory
knitr::opts_knit$set(root.dir = "../")
```

# Data story

Low et al (2016) examined the effects of two different anesthetics on aspects of the physiology of the mouse. Twelve mice were anesthetized with isoflurane and eleven mice were anesthetized with alpha chloralose and blood CO~2~ levels were recorded after 120 minutes. The H~0~ was that there was no difference between the anesthetics in the mean blood CO~2~ level. This is an independent comparison because individual mice were only given one of the two anesthetics.

## R

```{r packages}
library(tidyverse)

theme_set(theme_bw(base_size = 16) + 
            theme(panel.grid.minor = element_blank(), 
                  strip.background = element_blank()))
```

## The data

Describe what is happening in these lines of code.

```{r}
low <- read.csv("data/lowco2.csv")
```

\ 

. . . 

```{r}
names(low)
```

\

. . .

```{r}
dim(low)
```

\

. . . 

```{r}
str(low)
```


## Visualize data

```{r}
low %>% 
  ggplot(aes(anesth, co2)) + 
  geom_point(alpha = 0.5, size = 5) + 
  labs(x = "Anesthetic", y = "CO2") + 
  theme_bw(base_size = 24)
```

## Statistics vs parameters

. . . 

A **statistic** is

: a numerical description of a sample

. . .

A **parameter** is 

: a numerical attribute of a population

. . .

Often, *statistics* are used to estimate *parameters*. 
  

## Summarizing data: point estimates and variability

```{r}
low %>%  
  group_by(anesth) %>% 
  summarise(n = n(), 
            mean = mean(co2),
            median = median(co2),
            sd = sd(co2), 
            variance = var(co2), 
            se = sd / sqrt(n)
            )
```

**Your turn**.  
Add to the `summarise` function to calculate the 95% confidence interval for each treatment using `qt`. Interpret the CI. You should get the same answer as in the book. 

## Confidence intervals

```{r}
low %>%  
  group_by(anesth) %>% 
  summarise(n = n(), 
            mean = mean(co2),
            sd = sd(co2), 
            se = sd / sqrt(n), 
            CI_upper = mean + se * qt(p = 0.975, df = n-1), 
            CI_lower = mean + se * qt(p = 0.025, df = n-1), 
            CI = se * qt(p = 0.975, df = n-1), 
            upper = mean + CI, 
            lower = mean - CI
            )
```

In a frequentist world, parameters are fixed (but unknowable). Interpret the CI in this context. 

## Hypothesis testing

